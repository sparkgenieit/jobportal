import{G as I,r as p,c as T,h as v,j as e,M as C,E as g,u as E,R as F,m as H}from"./index-DW7Jtefv.js";import{T as _,j as V,k as N}from"./ShowMore-aN4txTUv.js";import{u as B,a7 as J,a8 as L}from"./index-BjWyLh7X.js";import{b as A,c as k}from"./index-CU5ar2BV.js";function U(s){return I({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M7.55197 13 8.39897 10.8852 9.24398 13H7.55197ZM16 12H17V14H16C15.4477 14 15 13.5523 15 13 15 12.4477 15.4477 12 16 12ZM21 3H3C2.44772 3 2 3.44772 2 4V20C2 20.5523 2.44772 21 3 21H21C21.5523 21 22 20.5523 22 20V4C22 3.44772 21.5523 3 21 3ZM12.598 16H10.443L10.043 15H6.75297L6.35297 16H4.19897L5.39797 13.002 5.39897 13 7.39897 8H9.39897L12.598 16ZM17 8H19V16H16C14.3431 16 13 14.6569 13 13 13 11.3431 14.3431 10 16 10H17V8Z"},child:[]}]})(s)}function Y(s){return I({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M12 14V22H4C4 17.5817 7.58172 14 12 14ZM12 13C8.685 13 6 10.315 6 7C6 3.685 8.685 1 12 1C15.315 1 18 3.685 18 7C18 10.315 15.315 13 12 13ZM21 17H22V22H14V17H15V16C15 14.3431 16.3431 13 18 13C19.6569 13 21 14.3431 21 16V17ZM19 17V16C19 15.4477 18.5523 15 18 15C17.4477 15 17 15.4477 17 16V17H19Z"},child:[]}]})(s)}function M({modal:s,setModal:t,handleDelete:a,closeJob:h,children:c}){const[x,j]=p.useState(""),[n,b]=p.useState(""),[d,u]=p.useState({}),y=B(),r=T(),l=r.role==="recruiter"?r.companyId.job_credits:r.job_credits,m=r.ad_credits;console.log(m,"ad_credits"),p.useEffect(()=>{s.type==="support"&&(b(""),j(""),u({})),s.type==="rejectedMessage"&&v.get(`/notifications/get-message/${s.clickedItem._id}`).then(o=>{j(o.data.message)}).catch(o=>{j("There was an error while fetching the message")})},[s]);const f=(o,i)=>{o(i.target.value),i.target.value.trim()===""?u({...d,[i.target.name]:!0}):u({...d,[i.target.name]:!1})},D=async o=>{o.preventDefault();let i={...d};if(n.trim()===""&&(i={...i,subject:!0}),x.trim()===""&&(i={...i,message:!0}),u(i),!i.subject&&!i.message)try{const w=r.role==="recruiter"?`${r.name}(${r.companyId.first_name+" "+r.companyId.last_name})`:r.first_name+" "+r.last_name,R={subject:n,participants:[r._id],chat:[{date:new Date,from:w,message:x,by:"employer"}],readBy:[r._id]};await v.post("/mails/employer/create",R),u({status:"Submitted"}),y({status:"success",message:"Support Request Sent",path:"/company/inbox"}),t({show:!1})}catch{u({status:"Failed"})}};return e.jsx(C,{show:s.show,onHide:()=>t({show:!1}),centered:!0,children:e.jsxs(C.Body,{style:{backgroundColor:"white"},children:[s.type==="delete"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"d-flex flex-column align-items-center",children:e.jsx("div",{className:"text-center",children:"Are you sure you want to delete this job? This action cannot be undone."})}),e.jsxs("div",{className:"d-flex justify-content-between px-5 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>a(s.clickedItem),className:"btn btn-danger rounded-pill",children:"Yes, Delete"}),e.jsx("button",{type:"button",onClick:()=>t({show:!1}),className:"btn btn-info rounded-pill",children:"Cancel"})]})]}),s.type==="repost"&&e.jsx(e.Fragment,{children:l>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"d-flex flex-column align-items-center",children:e.jsx("div",{className:"text-center fw-bold p-3",children:"Please review all details before reposting this job."})}),e.jsx("div",{className:"d-flex justify-content-center px-5",children:e.jsx(g,{to:`/company/editjob/${s.clickedItem._id}?repost=true`,children:e.jsx("button",{type:"button",className:"btn btn-info rounded-pill",children:"Ok"})})})]}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"d-flex flex-column align-items-center gap-3",children:[e.jsx("div",{children:"You don't have enough credits to repost the job"}),e.jsx("button",{type:"button",onClick:()=>t({show:!1}),className:"btn btn-outline-info rounded-pill",children:"Ok"})]})})}),s.type==="repostAd"&&e.jsx(e.Fragment,{children:m>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"d-flex flex-column align-items-center",children:e.jsx("div",{className:"text-center fw-bold p-3",children:"Please review all details before reposting this job."})}),e.jsx("div",{className:"d-flex justify-content-center px-5",children:e.jsx(g,{to:`/company/ads/editad/${s.clickedItem._id}?repost=true`,children:e.jsx("button",{type:"button",className:"btn btn-info rounded-pill",children:"Ok"})})})]}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"d-flex flex-column align-items-center gap-3",children:[e.jsx("div",{children:"You don't have enough credits to repost the job"}),e.jsx("button",{type:"button",onClick:()=>t({show:!1}),className:"btn btn-outline-info rounded-pill",children:"Ok"})]})})}),s.type==="rejectedMessage"&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"fw-bold",children:"Revise: Corrections Needed for Your Job Submission"}),e.jsx("p",{children:"  We have reviewed your recent job submission and found that some corrections are needed before it can be processed further. The details of the required corrections are as follows:"}),e.jsx("p",{className:"text-danger fw-bold",children:x}),e.jsx("p",{children:"Please make the necessary adjustments at your earliest convenience. Once the corrections have been made, kindly resubmit the job for further review."}),e.jsx("p",{children:"If you have any questions or need assistance with the corrections, please do not hesitate to reach out to us. We are here to help."}),e.jsx("p",{children:"Thank you for your attention to this matter."}),e.jsx(g,{to:`/company/editjob/${s.clickedItem._id}`,children:e.jsx("button",{type:"button",className:"btn btn-info rounded-4",children:"Edit Job"})})]}),s.type==="close"&&e.jsxs("div",{className:"py-3 px-1",children:[e.jsx("h4",{children:"Premature Job Closure"}),e.jsxs("p",{children:["You are attempting to close a job that is still active and has not yet reached its expiry date of ",e.jsx("strong",{children:new Date(s.clickedItem.closedate).toLocaleDateString("en-GB")}),". Please note that closing the job now will result in the forfeiture of any remaining advertising period. Additionally, please be aware that no credit or refund will be issued for the unused portion of the job posting period."]}),e.jsx("p",{children:"If you are certain you wish to proceed with closing the job early, please confirm. Otherwise, consider allowing the job to run its full course to maximize your recruitment efforts."}),e.jsxs("div",{className:"d-flex gap-5 pt-3 justify-content-end",children:[e.jsx("button",{type:"button",onClick:()=>h(s.clickedItem),className:"btn btn-danger rounded-pill",children:"Close"}),e.jsx("button",{type:"button",onClick:()=>t({show:!1}),className:"btn btn-outline-dark rounded-pill",children:"Cancel"})]})]}),s.type==="support"&&e.jsxs("div",{className:"py-3 px-1",children:[e.jsx("h4",{children:"Inquiry - Support Request"}),e.jsx("form",{onSubmit:D,children:e.jsxs("div",{className:"pt-3 d-flex flex-column justify-content-between gap-3 ",children:[s.clickedItem.jobTitle&&e.jsxs("div",{children:["Title: ",s.clickedItem.jobTitle]}),s.clickedItem.title&&e.jsxs("div",{children:["Title: ",s.clickedItem.title]}),e.jsxs("div",{children:["ID : ",s.clickedItem._id]}),s.clickedItem.employjobreference&&e.jsxs("div",{children:["Job Reference : ",s.clickedItem.employjobreference]}),e.jsxs("div",{className:"d-flex gap-3 align-items-center",children:[e.jsx("span",{children:"Subject:"}),e.jsx("div",{className:"w-100",children:e.jsx("input",{type:"text",name:"subject",className:`w-100 rounded  p-2 ${d.subject?"border-danger":"border-light-subtle"}`,value:n,onChange:o=>f(b,o)})})]}),e.jsxs("div",{children:[e.jsx("div",{children:"Message"}),e.jsx("textarea",{className:`w-100 rounded  p-2 ${d.message?"border-danger":"border-light-subtle"}`,rows:4,name:"message",value:x,onChange:o=>f(j,o)})]}),e.jsxs("div",{className:"text-center",children:[d.status==="Submitted"&&e.jsx("span",{className:"text-success",children:e.jsx("em",{children:"We will contact you soon regarding your job inquiry."})}),d.status==="Failed"&&e.jsx("span",{className:"text-danger",children:e.jsx("em",{children:"Failed to submit the inquiry."})})]}),e.jsx("div",{children:e.jsx("button",{className:"w-100 btn btn-success ",type:"submit",children:"Submit"})})]})})]}),!s.type&&e.jsx(e.Fragment,{children:c})]})})}const S={},O=({data:s,setModal:t})=>{switch(s.status){case"approved":return"Live";case"rejected":return e.jsxs("span",{role:"button",onClick:()=>t({show:!0,type:"rejectedMessage",clickedJob:s}),className:"text-red-600 flex items-center justify-center underline",children:[e.jsx(k,{})," Revise"]});case"expired":return"Expired";case"closed":return"Closed";case"LIVE":return"Live";case"REJECTED":return e.jsxs("span",{role:"button",onClick:()=>t({show:!0,type:"rejectedMessage",clickedJob:s}),className:"text-red-600 flex items-center justify-center underline",children:[e.jsx(k,{})," Revise"]});case"EXPIRED":return"Expired";case"QUEUE":return"In Queue";case"REVIEW":return"In Review";default:return"In Review"}},P=({dataType:s,data:t,goToEdit:a,handleDuplicate:h,setModal:c})=>e.jsxs(e.Fragment,{children:[e.jsx("td",{children:e.jsx("span",{className:"flex justify-center",children:e.jsx(J,{onClick:()=>a(t),role:"button"})})}),e.jsx("td",{children:e.jsx("span",{className:"flex justify-center",children:e.jsx(V,{onClick:()=>h(t),role:"button",fontSize:20})})}),e.jsx("td",{children:t.status==="approved"&&e.jsx("span",{className:"flex justify-center",role:"button",onClick:()=>c({show:!0,type:"close",clickedJob:t}),children:e.jsx(H,{color:"red",fontSize:22})})}),e.jsx("td",{children:(t.status==="closed"||t.status==="expired")&&e.jsx("span",{className:"flex justify-center",role:"button",onClick:()=>c({show:!0,type:"delete",clickedJob:t}),children:e.jsx(L,{fontSize:16})})}),s=="Job"&&e.jsx("td",{children:(t.status==="expired"||t.status==="closed")&&e.jsx("span",{className:"flex justify-center",role:"button",onClick:()=>c({show:!0,type:"repost",clickedItem:t}),children:e.jsx(N,{fontSize:24})})}),s=="Ad"&&e.jsx("td",{children:t.status==="EXPIRED"&&e.jsx("span",{className:"flex justify-center",role:"button",onClick:()=>c({show:!0,type:"repostAd",clickedItem:t}),children:e.jsx(N,{fontSize:24})})})]}),q=({dataType:s,data:t,setModal:a,getAppliedUsers:h,isTableCollapsed:c,goToEdit:x,handleDuplicate:j,columns:n})=>e.jsxs("tr",{children:[n.includes("Support")&&e.jsx("td",{children:e.jsx(A,{role:"button",onClick:()=>a({show:!0,type:"support",clickedItem:t,title:n.includes("Job Title")?t.jobTitle:t.title}),fontSize:20})}),n.includes("Job Title")&&e.jsx("td",{children:t.jobTitle}),n.includes("AD Title")&&e.jsx("td",{children:t.title}),n.includes("Job Reference")&&e.jsx("td",{children:t.employjobreference}),n.includes("Posted Date")&&e.jsx("td",{children:t.creationdate?new Date(t.creationdate).toLocaleDateString("en-GB"):new Date(t.date).toLocaleDateString("en-GB")}),n.includes("End Date")&&e.jsx("td",{children:t.creationdate?new Date(t.closedate).toLocaleDateString("en-GB"):new Date(t.end_date).toLocaleDateString("en-GB")}),n.includes("Status")&&e.jsx("td",{className:"text-center",children:e.jsx(O,{data:t,setModal:a})}),n.includes("Views")&&e.jsx("td",{id:"views",className:"text-end",children:t.views?t.views:0}),n.includes("Applications")&&e.jsxs("td",{children:[" ",e.jsx("td",{id:"Applicants",className:"text-center",children:t.status==="approved"&&e.jsx(e.Fragment,{children:t.appliedUsers?e.jsx("button",{type:"button",className:"border-0 bg-white text-blue-600 font-bold underline ",onClick:()=>h(t,!1),children:t.appliedUsers}):"0"})})]}),n.includes("Shortlisted")&&e.jsx("td",{children:t.status==="approved"&&t.shortlistedUsers&&e.jsx("button",{type:"button",className:"border-0 bg-white text-green-600 font-bold underline ",onClick:()=>h(t,!0),children:t.shortlistedUsers})}),c&&e.jsx(P,{dataType:s,data:t,goToEdit:x,handleDuplicate:j,setModal:a})]});function W({dataType:s,items:t,handleDuplicate:a,closeAction:h,getAppliedUsers:c,handleDelete:x,goToEdit:j,columns:n}){const b=E(l=>l.general.isSidebarOpen),[d,u]=p.useState({}),[y,r]=p.useState(!1);return console.log("ads",t),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:b?S.sidebarNotCollapsed:S.sidebarCollapsed,children:e.jsxs(_,{responsive:!0,className:"text-wrap text-center",children:[e.jsx("thead",{children:e.jsx("tr",{children:n.map((l,m)=>e.jsxs("th",{className:l==="Actions"?"text-blue-600":"",children:[l,l==="Actions"&&e.jsx(F,{fontSize:18,onClick:()=>r(f=>!f)})]},m))})}),e.jsx("tbody",{children:t.length>0&&t.map(l=>e.jsx(q,{dataType:s,data:l,setModal:u,getAppliedUsers:c,isTableCollapsed:y,goToEdit:j,handleDuplicate:a,columns:n},l._id))})]})}),e.jsx(M,{modal:d,setModal:u,handleDelete:x,closeAction:h})]})}export{W as D,M,U as R,Y as a};

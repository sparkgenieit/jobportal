import{e as S,c as T,r as s,a as C,h as k,j as e,S as $}from"./index-DW7Jtefv.js";import{t as P}from"./csvFunctions-zqwoPGxM.js";function A(){const[u]=S(),f=u.get("type"),o=T(),j=o.role==="recruiter"?o.companyId._id:o._id,[r,d]=s.useState([]),[p,a]=s.useState(!1),[i,n]=s.useState(""),[l,b]=s.useState(""),[c,N]=s.useState(""),[x,g]=s.useState(f),m=s.useRef(null),y=C();s.useEffect(()=>{h(),document.title="Download Transactions"},[]);const w=async()=>{if(g(x),a(!0),!c){n("From date is required"),a(!1);return}if(!l){n("To date is required"),a(!1);return}if(c>l){n("From date cannot be more than to date"),a(!1);return}n(""),await h(),a(!1)},v=()=>{y(-1)},h=async()=>{try{const t=await k.get(`/orders/download-transactions/${j}?from=${c}&to=${l}&type=${x.toLowerCase()}`);console.log("Response",t.data),d(t.data)}catch{d([])}};return e.jsxs("div",{className:"container-fluid mt-3",children:[e.jsx("button",{onClick:v,type:"button",className:"btn p-2 btn-dark btn-xs rounded-circle ",children:e.jsx($,{fontSize:16})}),e.jsxs("div",{className:"d-flex flex-column align-items-center justify-content-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:" flex grow-1 fw-bold fs-3 text-center",children:"Download Transactions"}),e.jsx("span",{className:"text-secondary small",children:e.jsx("em",{children:'Select a date range, then click "Apply" or "Download" to export all transactions.'})})]}),e.jsxs("form",{className:"d-flex flex-column flex-md-row gap-3",children:[e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("label",{className:"small fw-bold text-nowrap",children:"From date"}),e.jsx("input",{value:c,onChange:t=>{N(t.target.value)},type:"date",className:"form-control"})]}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("label",{className:"small fw-bold text-nowrap",children:"To date"}),e.jsx("input",{type:"date",className:"form-control",value:l,onChange:t=>b(t.target.value)})]}),e.jsx("button",{onClick:w,className:" btn btn-info rounded-4",type:"button",children:"Apply"}),e.jsx("button",{type:"button",disabled:p,onClick:()=>P(m.current,"transactions"),className:"btn btn-info rounded-4",children:"Download"})]}),i&&e.jsx("span",{className:"text-danger fw-bold",children:i})]}),e.jsx("div",{className:"mt-4 border-top border-2 table-responsive",children:e.jsxs("table",{ref:m,className:"w-100 table",children:[e.jsx("thead",{children:e.jsxs("tr",{style:{fontSize:"14px"},className:"text-center",children:[e.jsx("th",{children:"Transaction ID"}),e.jsx("th",{children:"Date"}),e.jsx("th",{className:"text-start",children:"Description"}),e.jsx("th",{className:"text-end",children:"Amount"}),e.jsx("th",{children:"Credits Purchased"}),e.jsx("th",{children:"Credits Used"}),e.jsx("th",{children:"Remaining Credits"}),e.jsx("th",{children:"Invoice Number"})]})}),e.jsx("tbody",{className:"border border-secondary ",children:r&&(r==null?void 0:r.map((t,D)=>e.jsxs("tr",{className:"text-center small border rounded",children:[e.jsx("td",{style:{fontSize:"10px"},className:"py-3",children:t._id}),e.jsx("td",{children:new Date(t.created_date).toLocaleDateString("en-GB")}),e.jsx("td",{className:"text-start",children:t.description}),e.jsx("td",{className:"text-end",children:t.amount?`$ ${t.amount}`:"$0"}),e.jsx("td",{children:t.creditsPurchased?t.creditsPurchased:"0"}),e.jsx("td",{children:t.creditsUsed}),e.jsx("td",{children:t.credits}),e.jsx("td",{children:t.invoiceNumber&&t.invoiceNumber})]},D)))})]})})]})}export{A as default};
